(this["webpackJsonpreviews-front"]=this["webpackJsonpreviews-front"]||[]).push([[0],{102:function(e,t,r){},105:function(e,t,r){},126:function(e,t,r){},127:function(e,t,r){},129:function(e,t,r){"use strict";r.r(t);var n,a=r(2),c=r.n(a),s=r(28),i=r.n(s),o=(r(97),function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,143)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;r(e),n(e),a(e),c(e),s(e)}))}),u=r(24),l=r(15),d=r(16),j=r(133),b=r(134),v=r(76),h=r(142),x=r(135),p=r(136),O=r(18),f=r(71),m=r(1),g=function(e){var t=e.className,r=e.title,n=e.onClick,a=e.children;return Object(m.jsxs)("div",{onClick:n,className:"Page ".concat(null!==t&&void 0!==t?t:""),children:[Object(m.jsx)(f.a,{children:Object(m.jsx)("title",{children:r?"Reviews - ".concat(r):"Reviews"})}),a]})},w=(r(102),"http://localhost:8080"),k=r(19),y=c.a.createContext({token:void 0,setToken:function(){}}),N=function(){return Object(a.useContext)(y)},C=function(e){var t=e.children,r=y.Provider,n=Object(a.useMemo)((function(){return localStorage.getItem("token")||void 0}),[]),c=Object(a.useState)(n),s=Object(k.a)(c,2),i=s[0],o=s[1],u=Object(a.useCallback)((function(e){e?localStorage.setItem("token",e):localStorage.removeItem("token"),o(e)}),[]),d=Object(a.useMemo)((function(){return{token:i,setToken:u}}),[i,u]),j=Object(l.useQueryClient)();return Object(a.useEffect)((function(){void 0===i&&j.clear()}),[j,i]),Object(m.jsx)(r,{value:d,children:t})},E=function(e){var t=e.visible,r=e.redirectUrl,n=e.children;return t?Object(m.jsx)(m.Fragment,{children:n}):void 0!==r?Object(m.jsx)(d.a,{to:r}):null},I=function(e){var t=e.redirectUrl,r=e.children,n=N().token;return Object(m.jsx)(E,{visible:void 0===n,redirectUrl:t,children:r})},A=Object(O.cn)("SignInPage"),T=function(e){var t=e.classname;return Object(m.jsx)(I,{redirectUrl:"/",children:Object(m.jsx)(g,{className:A(null,[t]),title:"Sign in",children:Object(m.jsx)(j.a,{children:Object(m.jsx)(b.a,{className:"d-flex align-items-center",children:Object(m.jsx)(v.a,{md:{span:4,offset:4},children:Object(m.jsxs)(h.a,{children:[Object(m.jsx)(h.a.Header,{children:"Sign in with"}),Object(m.jsxs)(h.a.Text,{className:"d-grid gap-2 p-2",children:[Object(m.jsxs)(x.a,{href:"".concat(w,"/oauth2/authorization/github"),variant:"outline-dark",children:[Object(m.jsx)("span",{className:"align-middle",children:"GitHub"})," ",Object(m.jsx)(p.b,{})]}),Object(m.jsxs)(x.a,{href:"".concat(w,"/oauth2/authorization/facebook"),variant:"outline-dark",children:[Object(m.jsx)("span",{className:"align-middle",children:"Facebook"}),Object(m.jsx)(p.a,{})]}),Object(m.jsxs)(x.a,{href:"".concat(w,"/oauth2/authorization/google"),variant:"outline-dark",children:[Object(m.jsx)("span",{className:"align-middle",children:"Google"})," ",Object(m.jsx)(p.c,{})]})]})]})})})})})})},R=r(137),G=(r(105),r(3)),L=r(77),U=r(78),S=r(79),D=r(83),Q=r(84);!function(e){e.NEED_AUTH="\u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u0430 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f"}(n||(n={}));var F,P=function(e){Object(S.a)(r,e);var t=Object(D.a)(r);function r(e,n){var a;return Object(L.a)(this,r),(a=t.call(this)).type=e,a.msg=n,a}return Object(U.a)(r,null,[{key:"typed",value:function(e){return new r(e,e)}}]),r}(Object(Q.a)(Error)),_=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=N(),c=a.token,s=a.setToken;return Object(l.useQuery)(e,t(c),Object(G.a)(Object(G.a)({retry:!1},r),{},{onError:function(e){e instanceof P&&e.type===n.NEED_AUTH&&s(void 0),r.onError&&r.onError(e)}}))};!function(e){e.ME="me",e.REVIEW="review",e.REVIEWS="reviews",e.CATEGORIES="categories",e.FOUND_REVIEWS="found_reviews"}(F||(F={}));var B=new l.QueryClient,V=r(6),M=r.n(V),H=r(11);function z(e,t){for(var r=function(){var r=a[n];if(!(r in e))return{v:!1};var c=t[r];return c?(Array.isArray(c)?c:[c]).some((function(t){return typeof e[r]===t}))?void 0:{v:!1}:"continue"},n=0,a=Object.keys(t);n<a.length;n++){var c=r();if("continue"!==c&&"object"===typeof c)return c.v}return!0}var W=function(e,t){return!!Array.isArray(e)&&e.every(t)},Y=function(e){return"string"===typeof e},J=function(e){return"object"===typeof e&&null!==e&&(!!z(e,{id:"number",author:"object",tittle:"string",content:"string",grade:"number",categories:"object",likesCount:"number",usersGradesAvg:["object","number"],tagsNames:"object",imagesUrls:"object"})&&((null===e.usersGradesAvg||"number"===typeof e.usersGradesAvg)&&(!!W(e.categories,Y)&&(!!W(e.tagsNames,Y)&&(!!W(e.imagesUrls,Y)&&!("object"!==typeof(t=e.author)||null===t||!z(t,{id:"number",username:"string",provider:"string"})))))));var t},q=r(14),K=r.n(q),X=function(e){return Object(H.a)(M.a.mark((function t(){var r,a,c;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,K.a.get("".concat(w,"/api/reviews"),{headers:{Authorization:"Bearer ".concat(e)}});case 5:if(r=t.sent,a=r.data,!W(a,J)){t.next=9;break}return t.abrupt("return",a);case 9:t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(2),!K.a.isAxiosError(t.t0)){t.next=17;break}if(403!==(null===(c=t.t0.response)||void 0===c?void 0:c.status)){t.next=16;break}throw P.typed(n.NEED_AUTH);case 16:throw t.t0;case 17:throw new Error;case 18:case"end":return t.stop()}}),t,null,[[2,11]])})))},Z=function(e){return function(){var t=Object(H.a)(M.a.mark((function t(r){var a,c,s,i;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,(a=new FormData).append("id",r.id.toString()),a.append("tittle",r.tittle),a.append("content",r.content),a.append("grade",r.grade.toString()),r.categories.forEach((function(e){return a.append("categories",e)})),r.tagsNames.forEach((function(e){return a.append("tagsNames",e)})),r.images.forEach((function(e){return a.append("images",e,e.name)})),t.next=13,K.a.put("".concat(w,"/api/reviews/").concat(r.id),a,{headers:{Authorization:"Bearer ".concat(e)}});case 13:if(c=t.sent,s=c.data,!J(s)){t.next=17;break}return t.abrupt("return",s);case 17:t.next=25;break;case 19:if(t.prev=19,t.t0=t.catch(2),!K.a.isAxiosError(t.t0)){t.next=25;break}if(403!==(null===(i=t.t0.response)||void 0===i?void 0:i.status)){t.next=24;break}throw P.typed(n.NEED_AUTH);case 24:throw t.t0;case 25:case"end":return t.stop()}}),t,null,[[2,19]])})));return function(e){return t.apply(this,arguments)}}()},$=function(e){return function(){var t=Object(H.a)(M.a.mark((function t(r){var a,c,s,i;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,(a=new FormData).append("tittle",r.tittle),a.append("content",r.content),a.append("grade",r.grade.toString()),r.categories.forEach((function(e){return a.append("categories",e)})),r.tagsNames.forEach((function(e){return a.append("tagsNames",e)})),r.images.forEach((function(e){return a.append("images",e,e.name)})),t.next=12,K.a.post("".concat(w,"/api/reviews"),a,{headers:{Authorization:"Bearer ".concat(e)}});case 12:if(c=t.sent,s=c.data,!J(s)){t.next=16;break}return t.abrupt("return",s);case 16:t.next=24;break;case 18:if(t.prev=18,t.t0=t.catch(2),!K.a.isAxiosError(t.t0)){t.next=24;break}if(403!==(null===(i=t.t0.response)||void 0===i?void 0:i.status)){t.next=23;break}throw P.typed(n.NEED_AUTH);case 23:throw t.t0;case 24:case"end":return t.stop()}}),t,null,[[2,18]])})));return function(e){return t.apply(this,arguments)}}()},ee=function(e){return function(){var t=Object(H.a)(M.a.mark((function t(r){var a,c,s;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,K.a.delete("".concat(w,"/api/reviews/").concat(r),{headers:{Authorization:"Bearer ".concat(e)}});case 5:if(a=t.sent,"number"!==typeof(c=a.data)){t.next=9;break}return t.abrupt("return",c);case 9:t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(2),!K.a.isAxiosError(t.t0)){t.next=17;break}if(403!==(null===(s=t.t0.response)||void 0===s?void 0:s.status)){t.next=16;break}throw P.typed(n.NEED_AUTH);case 16:throw t.t0;case 17:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()},te=r(138),re=r(141),ne=function(e){return Object(H.a)(M.a.mark((function t(){var r,a,c;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,K.a.get("".concat(w,"/api/users/me"),{headers:{Authorization:"Bearer ".concat(e)}});case 5:if(r=t.sent,a=r.data,"object"!==typeof(s=a)||null===s||!z(s,{id:"number",username:"string",provider:"string",reviews:"object"})||!W(s.reviews,J)){t.next=9;break}return t.abrupt("return",a);case 9:t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(2),!K.a.isAxiosError(t.t0)){t.next=17;break}if(403!==(null===(c=t.t0.response)||void 0===c?void 0:c.status)){t.next=16;break}throw P.typed(n.NEED_AUTH);case 16:throw t.t0;case 17:throw new Error;case 18:case"end":return t.stop()}var s}),t,null,[[2,11]])})))},ae=function(){var e=_(F.ME,ne,{staleTime:1/0});return{me:e.data,isLoading:e.isLoading}},ce=(r(126),Object(O.cn)("GlobalLayout")),se=function(e){var t=e.className,r=e.children,n=Object(d.g)(),c=Object(d.i)().text,s=Object(l.useQueryClient)(),i=ae().me,o=Object(a.useCallback)((function(){n.push("/me")}),[n]),u=Object(a.useCallback)((function(){n.push("/signIn")}),[n]),h=Object(a.useCallback)((function(){n.push("/")}),[n]),p=Object(a.useCallback)(function(){var e=Object(H.a)(M.a.mark((function e(t){var r,a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=t.currentTarget.elements,a=r.namedItem("searchingText").value,e.next=5,s.resetQueries(F.FOUND_REVIEWS);case 5:n.push("/reviews/search/result/".concat(encodeURIComponent(a)));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n,s]);return Object(m.jsxs)(j.a,{className:ce(null,[t]),children:[Object(m.jsxs)(b.a,{className:"align-items-baseline",children:[Object(m.jsx)(v.a,{className:ce("Top"),md:{span:2,offset:0},onClick:h,children:Object(m.jsx)("b",{children:"Reviews"})}),i?Object(m.jsx)(v.a,{className:ce("Top"),md:{span:2,offset:8},onClick:o,children:i.username}):Object(m.jsx)(v.a,{className:ce("Top"),md:{span:1,offset:9},onClick:o,children:Object(m.jsx)("div",{onClick:u,children:"authenticate"})})]}),Object(m.jsx)(b.a,{children:Object(m.jsx)(re.a,{onSubmit:p,children:Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"searchingText",children:[Object(m.jsx)(re.a.Label,{children:"search reviews"}),Object(m.jsxs)(b.a,{children:[Object(m.jsx)(v.a,{children:Object(m.jsx)(re.a.Control,{type:"text",defaultValue:c})}),Object(m.jsx)(v.a,{md:1,children:Object(m.jsx)(x.a,{variant:"dark",type:"submit",children:"search"})})]})]})})}),Object(m.jsx)("div",{children:r})]})},ie=Object(O.cn)("MainPage"),oe=function(e){var t=e.classname,r=function(){var e=_(F.REVIEWS,X,{staleTime:1/0});return{reviews:e.data,isLoading:e.isLoading}}().reviews,n=Object(d.g)(),c=Object(a.useCallback)((function(e){n.push("/reviews/".concat(e,"/read"))}),[n]);return Object(m.jsx)(g,{className:ie(null,[t]),title:"",children:Object(m.jsx)(se,{children:Object(m.jsx)(j.a,{children:Object(m.jsxs)(R.a,{children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{className:ie("ReviewTitleCol"),children:"Title"}),Object(m.jsx)("th",{className:ie("ReviewLikesCol"),children:"Likes"}),Object(m.jsx)("th",{className:ie("ReviewGradesCol"),children:"Users` grade avg"}),Object(m.jsx)("th",{className:ie("ReviewOpenCol")})]})}),Object(m.jsx)("tbody",{children:r?null===r||void 0===r?void 0:r.map((function(e){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{className:ie("ReviewTitleCol"),children:e.tittle}),Object(m.jsxs)("th",{className:ie("ReviewLikesCol"),children:[Object(m.jsx)(te.b,{})," ",e.likesCount]}),Object(m.jsxs)("th",{className:ie("ReviewGradesCol"),children:[Object(m.jsx)(te.c,{})," ",e.usersGradesAvg]}),Object(m.jsx)("th",{className:ie("ReviewOpenCol"),children:Object(m.jsx)(x.a,{variant:"dark",onClick:function(){return c(e.id)},children:"open"})})]},e.id)})):Object(m.jsx)(m.Fragment,{children:"No reviews"})})]})})})})},ue=function(e){e.classname;var t=N().setToken,r=Object(d.h)();return Object(a.useEffect)((function(){var e=new URLSearchParams(r.search).get("token");e&&t(e)}),[r.search,t]),Object(m.jsx)(I,{redirectUrl:"/",children:Object(m.jsx)(g,{children:"Redirecting..."})})},le=r(140),de=r(139),je=function(e,t){var r=_([F.REVIEW,e,t],function(e,t){return function(r){return Object(H.a)(M.a.mark((function a(){var c,s,i;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,a.next=5,K.a.get("".concat(w,"/api/reviews/").concat(e),{headers:{Authorization:"Bearer ".concat(r)},params:{markdown:t}});case 5:if(c=a.sent,s=c.data,!J(s)){a.next=9;break}return a.abrupt("return",s);case 9:a.next=17;break;case 11:if(a.prev=11,a.t0=a.catch(2),!K.a.isAxiosError(a.t0)){a.next=17;break}if(403!==(null===(i=a.t0.response)||void 0===i?void 0:i.status)){a.next=16;break}throw P.typed(n.NEED_AUTH);case 16:throw a.t0;case 17:throw new Error;case 18:case"end":return a.stop()}}),a,null,[[2,11]])})))}}(+e,"edit"===t),{staleTime:1/0});return{review:r.data,isLoading:r.isLoading}},be=function(e){var t=N(),r=t.token,c=t.setToken;return Object(a.useCallback)(Object(H.a)(M.a.mark((function t(){var a=arguments;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e(r).apply(void 0,a);case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),t.t0 instanceof P&&t.t0.type===n.NEED_AUTH&&c(void 0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,6]])}))),[e,r,c])},ve=function(e){return function(){var t=Object(H.a)(M.a.mark((function t(r){var a,c,s;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,K.a.post("".concat(w,"/api/reviews/").concat(r,"/like"),null,{headers:{Authorization:"Bearer ".concat(e)}});case 5:if(a=t.sent,c=a.data,!J(c)){t.next=9;break}return t.abrupt("return",c);case 9:t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(2),!K.a.isAxiosError(t.t0)){t.next=17;break}if(403!==(null===(s=t.t0.response)||void 0===s?void 0:s.status)){t.next=16;break}throw P.typed(n.NEED_AUTH);case 16:throw t.t0;case 17:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()},he=function(e){return function(){var t=Object(H.a)(M.a.mark((function t(r,a){var c,s,i;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,K.a.post("".concat(w,"/api/reviews/").concat(r,"/grade"),a,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 5:if(c=t.sent,s=c.data,!J(s)){t.next=9;break}return t.abrupt("return",s);case 9:t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(2),!K.a.isAxiosError(t.t0)){t.next=17;break}if(403!==(null===(i=t.t0.response)||void 0===i?void 0:i.status)){t.next=16;break}throw P.typed(n.NEED_AUTH);case 16:throw t.t0;case 17:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e,r){return t.apply(this,arguments)}}()},xe=(r(127),Object(O.cn)("ReviewPageRead")),pe=function(e){var t=e.className,r=Object(d.i)().reviewId,n=ae().me,s=je(r,"read").review,i=function(){var e=Object(l.useQueryClient)(),t=be(ve);return Object(a.useCallback)(function(){var r=Object(H.a)(M.a.mark((function r(n){var a;return M.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t(n);case 2:void 0!==(a=r.sent)&&e.setQueryData(F.REVIEW,a);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),[e,t])}(),o=Object(a.useCallback)(function(){var e=Object(H.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i]),u=function(){var e=Object(l.useQueryClient)(),t=be(he);return Object(a.useCallback)(function(){var r=Object(H.a)(M.a.mark((function r(n,a){var c;return M.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t(n,a);case 2:void 0!==(c=r.sent)&&e.setQueryData(F.REVIEW,c);case 4:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),[e,t])}(),h=Object(a.useCallback)(function(){var e=Object(H.a)(M.a.mark((function e(t,r){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(t,r);case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[u]);return Object(m.jsx)(g,{className:xe(null,[t]),title:"Review - read",children:Object(m.jsx)(se,{children:Object(m.jsxs)(j.a,{children:[Object(m.jsx)(b.a,{className:"justify-content-md-center",children:Object(m.jsx)("h1",{className:"text-center",children:null===s||void 0===s?void 0:s.tittle})}),Object(m.jsx)(b.a,{className:"justify-content-md-center",children:Object(m.jsx)(v.a,{className:"text-md-center",children:Object(m.jsxs)("h5",{children:["author: ",null===s||void 0===s?void 0:s.author.username,", author's grade: ",null===s||void 0===s?void 0:s.grade," ",Object(m.jsx)(te.c,{})]})})}),Object(m.jsx)(b.a,{className:"justify-content-md-center",children:Object(m.jsx)("div",{dangerouslySetInnerHTML:(null===s||void 0===s?void 0:s.content)?{__html:null===s||void 0===s?void 0:s.content}:void 0})}),Object(m.jsx)(b.a,{className:"justify-content-md-center",children:(null===s||void 0===s?void 0:s.imagesUrls)&&s.imagesUrls.length>0&&Object(m.jsx)(le.a,{children:s.imagesUrls.map((function(e){return Object(m.jsx)(le.a.Item,{children:Object(m.jsx)("img",{style:{width:"100vw",height:"auto"},src:"".concat(e),alt:"Failed to download"})},e)}))})}),Object(m.jsxs)(b.a,{children:["categories: ",null===s||void 0===s?void 0:s.categories.join(", ")]}),Object(m.jsxs)(b.a,{children:["tags: ",null===s||void 0===s?void 0:s.tagsNames.join(", ")]}),Object(m.jsxs)(b.a,{className:"justify-content-between px-3",children:[Object(m.jsx)(v.a,{md:"auto",children:(null===s||void 0===s?void 0:s.author.id)!==(null===n||void 0===n?void 0:n.id)?Object(m.jsxs)(x.a,{variant:"outline-dark",onClick:function(){return o(null===s||void 0===s?void 0:s.id)},children:[Object(m.jsx)(te.b,{className:xe("LikeButton",{active:!0})})," ",null===s||void 0===s?void 0:s.likesCount]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(te.b,{className:xe("LikeButton")})," ",null===s||void 0===s?void 0:s.likesCount]})}),Object(m.jsx)(v.a,{md:"auto",children:[0,1,2,3,4].map((function(e){return(null===s||void 0===s?void 0:s.author.id)!==(null===n||void 0===n?void 0:n.id)?Object(m.jsx)(x.a,{variant:"outline-dark",onClick:function(){return h(null===s||void 0===s?void 0:s.id,e+1)},children:(null===s||void 0===s?void 0:s.usersGradesAvg)?s.usersGradesAvg<=e?Object(m.jsx)(te.c,{}):s.usersGradesAvg<e+1?Object(m.jsx)(de.a,{}):Object(m.jsx)(te.a,{}):Object(m.jsx)(te.c,{})},e):Object(m.jsx)(c.a.Fragment,{children:(null===s||void 0===s?void 0:s.usersGradesAvg)?s.usersGradesAvg<=e?Object(m.jsx)(te.c,{}):s.usersGradesAvg<e+1?Object(m.jsx)(de.a,{}):Object(m.jsx)(te.a,{}):Object(m.jsx)(te.c,{})},e)}))})]})]})})})},Oe=function(e){var t=e.redirectUrl,r=e.children,n=N().token;return Object(m.jsx)(E,{visible:void 0!==n,redirectUrl:t,children:r})},fe=Object(O.cn)("MePage"),me=function(e){var t=e.className,r=ae().me,n=Object(d.g)(),c=Object(a.useCallback)((function(e){n.push("/reviews/".concat(e,"/edit"))}),[n]),s=Object(a.useCallback)((function(e){n.push("/reviews/".concat(e,"/read"))}),[n]),i=function(){var e=Object(l.useQueryClient)(),t=be(ee);return Object(a.useCallback)(function(){var r=Object(H.a)(M.a.mark((function r(n){var a,c;return M.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t(n);case 2:void 0!==(a=r.sent)&&(c=e.getQueryData(F.ME))&&e.setQueryData(F.ME,Object(G.a)(Object(G.a)({},c),{},{reviews:c.reviews.filter((function(e){return e.id!==a}))}));case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),[e,t])}(),o=Object(a.useCallback)((function(e){i(e)}),[i]),u=Object(a.useCallback)((function(){n.push("/me/reviews/create")}),[n]);return Object(m.jsx)(Oe,{redirectUrl:"/signIn",children:Object(m.jsx)(g,{className:fe(null,[t]),title:"Your profile",children:Object(m.jsx)(se,{children:Object(m.jsxs)(j.a,{children:[Object(m.jsx)(b.a,{children:Object(m.jsxs)(v.a,{children:[null===r||void 0===r?void 0:r.username," (",null===r||void 0===r?void 0:r.provider,")"]})}),Object(m.jsx)(b.a,{children:Object(m.jsx)(v.a,{children:"Your reviews:"})}),(null===r||void 0===r?void 0:r.reviews)&&r.reviews.length>0?r.reviews.map((function(e){return Object(m.jsxs)(b.a,{className:"mb-1",children:[Object(m.jsx)(v.a,{sm:7,children:e.tittle}),Object(m.jsx)(v.a,{children:Object(m.jsx)(x.a,{variant:"dark",onClick:function(){return s(e.id)},children:"read"})}),Object(m.jsx)(v.a,{children:Object(m.jsx)(x.a,{variant:"dark",onClick:function(){return c(e.id)},children:"edit"})}),Object(m.jsx)(v.a,{children:Object(m.jsx)(x.a,{variant:"dark",onClick:function(){return o(e.id)},children:"delete"})}),Object(m.jsxs)(v.a,{sm:1,children:[Object(m.jsx)(te.b,{})," ",e.likesCount]}),Object(m.jsxs)(v.a,{sm:1,children:[Object(m.jsx)(te.c,{})," ",e.usersGradesAvg]})]},e.id)})):Object(m.jsx)(b.a,{children:Object(m.jsx)(v.a,{children:"You didn`t upload reviews yet"})}),Object(m.jsx)(b.a,{children:Object(m.jsx)(x.a,{variant:"outline-dark",onClick:u,children:"Create new review"})})]})})})})},ge=r(33),we=function(e){return Object(H.a)(M.a.mark((function t(){var r,a,c;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,K.a.get("".concat(w,"/api/reviews/categories"),{headers:{Authorization:"Bearer ".concat(e)}});case 5:if(r=t.sent,a=r.data,!W(a,Y)){t.next=9;break}return t.abrupt("return",a);case 9:t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(2),!K.a.isAxiosError(t.t0)){t.next=17;break}if(403!==(null===(c=t.t0.response)||void 0===c?void 0:c.status)){t.next=16;break}throw P.typed(n.NEED_AUTH);case 16:throw t.t0;case 17:throw new Error;case 18:case"end":return t.stop()}}),t,null,[[2,11]])})))},ke=function(){var e=_(F.CATEGORIES,we,{staleTime:1/0});return{categories:e.data,isLoading:e.isLoading}},ye=Object(O.cn)("ReviewPage"),Ne=function(e){var t=e.className,r=Object(d.i)().reviewId,n=Object(d.g)(),c=ae().me,s=je(r,"edit").review,i=ke().categories,o=function(){var e=Object(l.useQueryClient)(),t=be(Z);return Object(a.useCallback)(function(){var r=Object(H.a)(M.a.mark((function r(n){var a,c;return M.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t(n);case 2:return void 0!==(a=r.sent)&&(e.setQueryData(F.REVIEW,a),(c=e.getQueryData(F.ME))&&e.setQueryData(F.ME,Object(G.a)(Object(G.a)({},c),{},{reviews:c.reviews.map((function(e){return e.id===a.id?a:e}))}))),r.abrupt("return",a);case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),[e,t])}(),u=Object(a.useCallback)(function(){var e=Object(H.a)(M.a.mark((function e(t){var r,a,c,i,u,l,d,j;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),s){e.next=3;break}return e.abrupt("return");case 3:return r=t.currentTarget.elements,a=r.namedItem("tittle").value,c=Number(r.namedItem("grade").value),i=r.namedItem("content").value,u=r.namedItem("tagsNames").value.split(/\s*,\s*/g),l=Object(ge.a)(r.namedItem("categories").values()).map((function(e){return e.checked&&e.value})).filter(Boolean),d=Array.from(r.namedItem("images").files),e.next=12,o({id:s.id,tittle:a,grade:c,content:i,tagsNames:u,categories:l,images:d});case 12:(j=e.sent)&&n.push("/reviews/".concat(null===j||void 0===j?void 0:j.id,"/read"));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n,s,o]);return Object(m.jsx)(Oe,{redirectUrl:"/signIn",children:Object(m.jsx)(g,{className:ye(null,[t]),title:"Review - edit",children:Object(m.jsx)(j.a,{children:(null===s||void 0===s?void 0:s.author.id)===(null===c||void 0===c?void 0:c.id)?Object(m.jsxs)(re.a,{onSubmit:u,children:[Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"tittle",children:[Object(m.jsx)(re.a.Label,{children:"Tittle"}),Object(m.jsx)(re.a.Control,{name:"tittle",type:"text",defaultValue:null===s||void 0===s?void 0:s.tittle})]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"grade",children:[Object(m.jsx)(re.a.Label,{children:"Your grade"}),Object(m.jsxs)(re.a.Select,{name:"grade",children:[Object(m.jsx)("option",{children:null===s||void 0===s?void 0:s.grade}),(null===s||void 0===s?void 0:s.grade)&&[1,2,3,4,5].map((function(e){return e!==(null===s||void 0===s?void 0:s.grade)&&Object(m.jsx)("option",{value:e,children:e})}))]})]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"content",children:[Object(m.jsx)(re.a.Label,{children:"Content"}),Object(m.jsx)(re.a.Control,{name:"content",as:"textarea",rows:20,defaultValue:null===s||void 0===s?void 0:s.content})]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"tagsNames",children:[Object(m.jsx)(re.a.Label,{children:"Input tags, separated by comma"}),Object(m.jsx)(re.a.Control,{name:"tags",type:"text",defaultValue:null===s||void 0===s?void 0:s.tagsNames.join(", ")})]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"categories",children:["Categories: ",null===i||void 0===i?void 0:i.map((function(e){return Object(m.jsx)(re.a.Check,{name:"categories",id:e,label:e,type:"checkbox",inline:!0,defaultChecked:null===s||void 0===s?void 0:s.categories.includes(e),value:e},e)}))]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"images",children:[Object(m.jsx)(re.a.Label,{children:"Images. Supported formats: JPG, PNG, GIF, BMP, ICO, SVG"}),Object(m.jsx)(re.a.Control,{name:"images",type:"file",multiple:!0,accept:"image/png"})]}),Object(m.jsx)(x.a,{variant:"dark",type:"submit",children:"Apply changes"})]}):Object(m.jsx)(b.a,{children:Object(m.jsx)(v.a,{children:"You can edit only your reviews"})})})})})},Ce=Object(O.cn)("ReviewPage"),Ee=function(e){var t=e.className,r=Object(d.g)(),n=ke().categories,c=function(){var e=Object(l.useQueryClient)(),t=be($);return Object(a.useCallback)(function(){var r=Object(H.a)(M.a.mark((function r(n){var a,c;return M.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t(n);case 2:return void 0!==(a=r.sent)&&(e.setQueryData(F.REVIEW,a),(c=e.getQueryData(F.ME))&&e.setQueryData(F.ME,Object(G.a)(Object(G.a)({},c),{},{reviews:[].concat(Object(ge.a)(c.reviews),[a])}))),r.abrupt("return",a);case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),[e,t])}(),s=Object(a.useCallback)(function(){var e=Object(H.a)(M.a.mark((function e(t){var n,a,s,i,o,u,l,d;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.currentTarget.elements,a=n.namedItem("tittle").value,s=Number(n.namedItem("grade").value),i=n.namedItem("content").value,o=n.namedItem("tagsNames").value.split(/\s*,\s*/g),u=Object(ge.a)(n.namedItem("categories").values()).map((function(e){return e.checked&&e.value})).filter(Boolean),l=Array.from(n.namedItem("images").files),e.next=10,c({tittle:a,grade:s,content:i,tagsNames:o,categories:u,images:l});case 10:(d=e.sent)&&r.push("/reviews/".concat(null===d||void 0===d?void 0:d.id,"/read"));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[c,r]);return Object(m.jsx)(Oe,{redirectUrl:"/signIn",children:Object(m.jsx)(g,{className:Ce(null,[t]),title:"Review - edit",children:Object(m.jsx)(j.a,{children:Object(m.jsxs)(re.a,{onSubmit:s,children:[Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"tittle",children:[Object(m.jsx)(re.a.Label,{children:"Tittle"}),Object(m.jsx)(re.a.Control,{name:"tittle",type:"text"})]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"grade",children:[Object(m.jsx)(re.a.Label,{children:"Your grade"}),Object(m.jsx)(re.a.Select,{name:"grade",children:[1,2,3,4,5].map((function(e){return Object(m.jsx)("option",{value:e,children:e})}))})]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"content",children:[Object(m.jsx)(re.a.Label,{children:"Content"}),Object(m.jsx)(re.a.Control,{name:"content",as:"textarea",rows:20})]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"tagsNames",children:[Object(m.jsx)(re.a.Label,{children:"Input tags, separated by comma"}),Object(m.jsx)(re.a.Control,{name:"tags",type:"text"})]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"categories",children:["Categories: ",null===n||void 0===n?void 0:n.map((function(e){return Object(m.jsx)(re.a.Check,{name:"categories",id:e,label:e,type:"checkbox",inline:!0,value:e},e)}))]}),Object(m.jsxs)(re.a.Group,{className:"mb-3",controlId:"images",children:[Object(m.jsx)(re.a.Label,{children:"Images. Supported formats: JPG, PNG, GIF, BMP, ICO, SVG"}),Object(m.jsx)(re.a.Control,{name:"images",type:"file",multiple:!0,accept:"image/png"})]}),Object(m.jsx)(x.a,{variant:"dark",type:"submit",children:"Create review"})]})})})})},Ie=function(e){var t=Object(l.useQuery)([F.FOUND_REVIEWS,e],function(e){return Object(H.a)(M.a.mark((function t(){var r,n;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,K.a.get("".concat(w,"/api/reviews/search"),{params:{text:e}});case 2:if(r=t.sent,n=r.data,!W(n,J)){t.next=6;break}return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})))}(e),{retry:!1,staleTime:1/0});return{reviews:t.data,isLoading:t.isLoading}},Ae=Object(O.cn)("SearchResult"),Te=function(e){e.className;var t=Object(d.i)().text,r=Ie(t||"").reviews,n=Object(d.g)(),c=Object(a.useCallback)((function(e){n.push("/reviews/".concat(e,"/read"))}),[n]);return Object(m.jsx)(g,{title:'Search results for "'.concat(t,'"'),children:Object(m.jsx)(se,{children:Object(m.jsxs)(R.a,{children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{className:Ae("ReviewTitleCol"),children:"Title"}),Object(m.jsx)("th",{className:Ae("ReviewLikesCol"),children:"Likes"}),Object(m.jsx)("th",{className:Ae("ReviewGradesCol"),children:"Users` grade avg"}),Object(m.jsx)("th",{className:Ae("ReviewOpenCol")})]})}),Object(m.jsx)("tbody",{children:r?r.map((function(e){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{className:Ae("ReviewTitleCol"),children:e.tittle}),Object(m.jsxs)("th",{className:Ae("ReviewLikesCol"),children:[Object(m.jsx)(te.b,{})," ",e.likesCount]}),Object(m.jsxs)("th",{className:Ae("ReviewGradesCol"),children:[Object(m.jsx)(te.c,{})," ",e.usersGradesAvg]}),Object(m.jsx)("th",{className:Ae("ReviewOpenCol"),children:Object(m.jsx)(x.a,{variant:"dark",onClick:function(){return c(e.id)},children:"open"})})]},e.id)})):Object(m.jsx)(m.Fragment,{children:"No reviews"})})]})})})},Re=Object(m.jsxs)(d.d,{children:[Object(m.jsx)(d.b,{path:"/signIn",exact:!0,children:Object(m.jsx)(T,{})}),Object(m.jsx)(d.b,{path:"/",exact:!0,children:Object(m.jsx)(oe,{})}),Object(m.jsx)(d.b,{path:"/me",exact:!0,children:Object(m.jsx)(me,{})}),Object(m.jsx)(d.b,{path:"/redirect",exact:!0,children:Object(m.jsx)(ue,{})}),Object(m.jsx)(d.b,{path:"/reviews/:reviewId/read",exact:!0,children:Object(m.jsx)(pe,{})}),Object(m.jsx)(d.b,{path:"/reviews/:reviewId/edit",exact:!0,children:Object(m.jsx)(Ne,{})}),Object(m.jsx)(d.b,{path:"/me/reviews/create",exact:!0,children:Object(m.jsx)(Ee,{})}),Object(m.jsx)(d.b,{path:["/reviews/search/result/:text","/reviews/search/result"],children:Object(m.jsx)(Te,{})})]}),Ge=(r(128),function(){return Object(m.jsx)(l.QueryClientProvider,{client:B,children:Object(m.jsx)(C,{children:Object(m.jsx)(u.a,{children:Re})})})});i.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(Ge,{})}),document.getElementById("root")),o()},97:function(e,t,r){}},[[129,1,2]]]);
//# sourceMappingURL=main.03d64143.chunk.js.map